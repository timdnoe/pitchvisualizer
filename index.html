<head>
	<script src="https://cdn.jsdelivr.net/npm/p5@1.7.0/lib/p5.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/0.5.8/addons/p5.sound.js"></script>
	<script src="https://code.jquery.com/jquery-3.6.3.min.js"></script>
	<script language="javascript" type="text/javascript" src="sketch.js"></script> 
  
</head>

<body onload="preload();">
	<h1>
		See the Color of Sound
	</h1>
	<div class="slidecontainer" style="display:none">
	  <input type="range" min="1" max="1000" value="42" class="slider" id="myRange">
	  <p>Width Value: <span id="demo"></span></p>
	</div>

	<div class="slidecontainer" style="display:none">
	  <input type="range" min="0" max="100" value="20" class="slider" id="myRange2">
	  <p>Smooth Value: <span id="demo2"></span></p>
	</div>

	<div class="slidecontainer" style="display:none">
	  <input type="range" min="0" max="255" value="0" class="slider" id="myRange3">
	  <p>Min Amp Value: <span id="demo3"></span></p>
	</div>


	<canvas id = "myCanvas">
	 <p>Your browser does not support the canvas tag...</p>
	</canvas>
	

	<br />
	<br />
	<button onclick="micOnOff()">Use Your Microphone for Realtime Visualization</button>
	<button onclick="playSong()">Play Song</button>

	<br />
	<h3>
	Viewing Settings
</h3>
	<br />
	<button onclick="backgroundInvert()">Invert Background</button>
		<button onclick="pianoOnOff()">Show Piano</button>
	<!--<button onclick="diffractOnOff()">Diffract</button>-->

	<br />

	<input type="file" id="rll" />
	<audio id="rllly" controls>
	  <source src="" id="rlly" />
	</audio>


<script>

var micText = "Mic Off"
var micOn = 0;
var backgroundWhite = 0;
var pianoOn = 1;
var diffractOn = 0;
var soundFile;

var slider = document.getElementById("myRange");
var output = document.getElementById("demo");
output.innerHTML = slider.value;

slider.oninput = function() {
  output.innerHTML = this.value;
  // console.log(this.value);
}

var slider2 = document.getElementById("myRange2");
var output2 = document.getElementById("demo2");
output2.innerHTML = slider2.value;

slider2.oninput = function() {
  output2.innerHTML = this.value;
  // console.log(this.value);
}

var slider3 = document.getElementById("myRange3");
var output3 = document.getElementById("demo3");
output3.innerHTML = slider3.value;

slider3.oninput = function() {
  output3.innerHTML = this.value;
  // console.log(this.value);
}

var filePlaying = null;
var soundFile2 = null;

var reader = new FileReader();

function handleFiles(event) {
	console.log("handleFiles, index 100")
	var files = event.target.files;
	soundFile2 = loadSound(files[0]);
}

document.getElementById("rll").addEventListener("change", handleFiles, false);

function playSong(){

	if (soundFile2.isLoaded()){

		if (soundFile2.isPlaying()){
			console.log("pause song, index 123")
			soundFile2.pause();
			//micOn = 1;
		}

		else {
			console.log("play song, index 126")
			//soundFile2.loop();
			soundFile2.play();
			//soundFile2.pause();
			micOn = 0;
		}

	}

	else{
			console.log("Song not loaded.");
	}

}

function micOnOff() {
	micOn = (micOn + 1) % 2;

	if (micOn){
		micText = "Mic Off";
	}
	else{
		micText = "Mic On";
	}

}

function backgroundInvert(){
	backgroundWhite = (backgroundWhite + 1) % 2;
}

function preload() {
  //soundFormats('mp3', 'ogg');
  //soundFile2 = loadSound('https://static.wixstatic.com/mp3/9f9440_806b624e3e0446bebc21a09ea2f92487.mp3?dn=Planetary+Alignment1.2.mp3');
}
	
      
function pianoOnOff(){
	pianoOn = (pianoOn + 1) % 2;
}
function diffractOnOff(){
	diffractOn = (diffractOn + 1) % 2;
}


</script>
</body>